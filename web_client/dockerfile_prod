# Oil Database Web Client production Docker configuration
#
FROM registry.orr.noaa.gov/erd/centos-conda

RUN yum update -y && yum -y install node npm nginx

ARG PROJECT_ROOT=$PWD

WORKDIR web_client

RUN npm install -g n
RUN n stable
RUN node --version

RUN npm install npm@latest -g
RUN npm install
RUN npm --version

RUN npm install -g ember-cli

RUN ember build --environment production

RUN ls -la
RUN ls -la ./dist

COPY dist/* /usr/share/nginx/html/

WORKDIR $PROJECT_ROOT

COPY oildb-deploy/config/web_client/* /config/

ENTRYPOINT ["/usr/sbin/nginx", "-g", "daemon off;"]
